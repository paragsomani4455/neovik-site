<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Build • Neovik Advisors</title>
  <link rel="stylesheet" href="/style.css?v=9">
  <style>
    body{background:#0b0b0f;color:#eaeaf0;font-family:system-ui,Segoe UI,Inter,Arial,sans-serif}
    .wrap{max-width:960px;margin:40px auto;padding:0 16px}
    .card{background:rgba(255,255,255,.05);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:20px}
    label{display:block;margin-top:12px;font-size:14px;opacity:.9}
    input,textarea,select{width:100%;margin-top:6px;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#11121a;color:#fff}
    textarea{min-height:72px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{display:inline-block;margin-top:16px;padding:12px 16px;border-radius:12px;border:1px solid #5b31a4;background:#6739B7;color:#fff;cursor:pointer}
    .muted{opacity:.75}
    pre{white-space:pre-wrap;background:#0f1018;border:1px solid rgba(255,255,255,.08);padding:16px;border-radius:12px;max-height:480px;overflow:auto}
    .ok{color:#7CF5A1}.err{color:#ff8f8f}
  </style>
</head>
<body>
<header class="wrap" style="display:flex;align-items:center;gap:12px;">
  <img src="/neovik-logo.png" alt="Neovik Advisors" width="36" height="36">
  <strong>Neovik Advisors</strong>
  <a href="/" style="margin-left:auto" class="muted">Home</a>
</header>

<main class="wrap">
  <h1>Generate Seed-Grade Outline</h1>
  <p class="muted">Fill the basics → click Generate → get a 12-slide outline + proof TODOs.</p>

  <div class="card">
    <div class="row">
      <div><label>Startup name<input id="startup" required></label></div>
      <div><label>One-liner<input id="one_liner" placeholder="What you do in one sentence" required></label></div>
    </div>

    <div class="row">
      <div><label>Industry
        <select id="industry">
          <option>SaaS</option><option>Fintech</option><option>Consumer</option><option>Health</option><option>Other</option>
        </select>
      </label></div>
      <div><label>Target user<input id="target_user" placeholder="Who feels the pain?" required></label></div>
    </div>

    <label>Problem (2–3 lines)<textarea id="problem" required></textarea></label>
    <label>Solution / product (2–3 lines)<textarea id="solution" required></textarea></label>

    <div class="row">
      <label>GTM (2 lines)<textarea id="gtm"></textarea></label>
      <label>Business model (2 lines)<textarea id="business_model"></textarea></label>
    </div>

    <div class="row">
      <label>Traction (optional)<textarea id="traction"></textarea></label>
      <label>Competition (names)<textarea id="competition"></textarea></label>
    </div>

    <div class="row">
      <label>Moat / edge (1–2 lines)<textarea id="moat"></textarea></label>
      <label>Ask &amp; use of funds<textarea id="ask_use"></textarea></label>
    </div>

    <div><label>Tone
      <select id="tone"><option>crisp</option><option>narrative</option><option>technical</option></select>
    </label></div>

    <button id="go" class="btn">Generate</button>
    <span id="status" class="muted"></span>
  </div>

  <div id="out" style="margin-top:20px"></div>
</main>

<script>
const $ = id => document.getElementById(id);
const endpoint = "/.netlify/functions/generate-outline";
$("go").onclick = async () => {
  $("status").innerText = "Generating…";
  $("go").disabled = true;

  const payload = {
    startup: $("startup").value, one_liner: $("one_liner").value,
    industry: $("industry").value, target_user: $("target_user").value,
    problem: $("problem").value, solution: $("solution").value,
    gtm: $("gtm").value, business_model: $("business_model").value,
    traction: $("traction").value, competition: $("competition").value,
    moat: $("moat").value, ask_use: $("ask_use").value,
    tone: $("tone").value
  };

  try {
    const res = await fetch(endpoint, {
      method:"POST",
      headers:{"content-type":"application/json"},
      body: JSON.stringify(payload)
    });
    const text = await res.text();
    if (!res.ok) throw new Error(text.slice(0,300));
    const data = JSON.parse(text);
    render(data);
    $("status").innerHTML = "<span class='ok'>Done.</span>";
  } catch (e) {
    $("out").innerHTML = "<pre class='err'>"+e.message+"</pre>";
    $("status").innerHTML = "<span class='err'>Failed.</span>";
  } finally {
    $("go").disabled = false;
  }
};

function render(data){
  const deck = data.deck || {};
  const slides = deck.slides || [];
  let html = `<div class="card"><h2>Outline for ${escapeHtml(deck?.meta?.startup||"")}</h2>`;
  slides.forEach(s=>{
    html += `<h3>${escapeHtml(s.title||"")}</h3><p class="muted">${escapeHtml(s.purpose||"")}</p><ul>`;
    (s.bullets||[]).forEach(b=> html+=`<li>${escapeHtml(b)}</li>`);
    html += `</ul><p class="muted">Visual: ${escapeHtml(s.visual||"")}</p>`;
  });
  if (deck.proof_todos?.length){
    html += `<h3>Proof TODOs</h3><ul>` + deck.proof_todos.map(t=>`<li>${escapeHtml(t)}</li>`).join("") + `</ul>`;
  }
  if (deck.warnings?.length){
    html += `<h3>Warnings</h3><ul>` + deck.warnings.map(t=>`<li>${escapeHtml(t)}</li>`).join("") + `</ul>`;
  }
  html += `<button class="btn" onclick='downloadJson(${JSON.stringify(JSON.stringify(data))})'>Download JSON</button></div>`;
  $("out").innerHTML = html;
}
function downloadJson(s){
  const blob = new Blob([JSON.parse(s)], {type:"application/json"});
  const a = document.createElement("a");
  a.href = URL.createObjectURL(blob);
  a.download = "neovik_deck.json";
  a.click();
}
function escapeHtml(x){return (x||"").replace(/[&<>"]/g, m=>({ "&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[m]));}
</script>
</body>
</html>
